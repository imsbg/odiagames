<!DOCTYPE html>
<html lang="or">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- DYNAMIC SEO TAGS: These are placeholders and will be replaced by JavaScript -->
    <title>Odia Games Blog</title>
    <meta name="description" content="Read articles from the Odia Games blog.">
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="Odia Games Blog">
    <meta property="og:description" content="Read articles from the Odia Games blog.">
    <meta property="og:image" content="https://odiagames.site/odiagames.png">
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Odia Games Blog">
    <meta name="twitter:description" content="Read articles from the Odia Games blog.">
    <meta name="twitter:image" content="https://odiagames.site/odiagames.png">
    
    <meta name="theme-color" content="#f4f7fc" />
    <link rel="preconnect" href="https://fonts.googleapis.com" /><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Oriya:wght@400;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" />

    <style>
        /* CSS is identical to blog.html, but with single post styles added */
        :root {--bg-color: #f4f7fc;--card-color: #ffffff;--text-color: #1c1c1e;--sub-text-color: #6c757d;--primary-color: #0a2463;--shadow: 0 10px 30px rgba(0, 0, 0, 0.07);}
        * {margin: 0;padding: 0;box-sizing: border-box;}
        html {scroll-behavior: smooth;}
        body {font-family: "Poppins", sans-serif;background-color: var(--bg-color);color: var(--text-color);line-height: 1.6;display: flex;flex-direction: column;min-height: 100vh;}
        body.or-lang {font-family: "Noto Sans Oriya", sans-serif;}
        .container {max-width: 1200px;margin: 0 auto;padding: 0 20px;}
        main {flex-grow: 1;padding-top: 2rem;}
        header {padding: 1.25rem 0;position: sticky;top: 0;z-index: 1000;background-color: rgba(244, 247, 252, 0.85);backdrop-filter: blur(10px);-webkit-backdrop-filter: blur(10px);border-bottom: 1px solid rgba(0, 0, 0, 0.05);}
        .header-content {display: flex;justify-content: space-between;align-items: center;}
        .header-left {font-size: 1.5rem;font-weight: 700;text-decoration: none;color: var(--text-color);}
        .header-right {display: flex;align-items: center;gap: 1rem;}
        .main-nav.desktop-nav {display: flex;align-items: center;gap: 1rem;}
        .main-nav.desktop-nav a {text-decoration: none;color: var(--text-color);font-weight: 500;transition: color 0.3s;padding: 0.5rem;display: flex;align-items: center;gap: 0.5rem;}
        .main-nav.desktop-nav a:hover {color: var(--primary-color);}
        .icon-btn, #menu-toggle {background: none; border: none; cursor: pointer; font-size: 1.5rem; color: var(--text-color); padding: 0.5rem;}
        .lang-toggle-btn {background-color: var(--primary-color);color: #fff;border: none;width: 40px;height: 40px;border-radius: 50%;cursor: pointer;font-size: 1.1rem;font-weight: 700;display: flex;justify-content: center;align-items: center;line-height: 1;transition: all 0.3s;}
        #menu-toggle {display: none;}
        .mobile-nav {visibility: hidden;opacity: 0;position: fixed;top: 0;left: 0;width: 100%;height: 100%;background: rgba(26, 26, 30, 0.3);backdrop-filter: blur(5px);z-index: 2000;transition: opacity 0.3s, visibility 0.3s;}
        .mobile-nav.active {visibility: visible;opacity: 1;}
        .mobile-nav-panel {background: var(--card-color);width: 100%;padding: 1.5rem 1.25rem;box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);display: flex;flex-direction: column;gap: 1rem;border-bottom-left-radius: 1rem;border-bottom-right-radius: 1rem;transform: translateY(-100%);transition: transform 0.3s ease-out;}
        .mobile-nav.active .mobile-nav-panel {transform: translateY(0);}
        .mobile-nav a {font-size: 1.2rem;text-decoration: none;color: var(--text-color);display: flex;align-items: center;gap: 0.75rem;padding: 0.5rem;}
        @media (max-width: 992px) {.main-nav.desktop-nav {display: none;} #menu-toggle {display: block;}}
        footer {background: var(--bg-color);color: var(--text-color);padding: 2rem 0;text-align: center;margin-top: 4rem;border-top: 1px solid #e0e0e0;}
        footer p {font-weight: bold;}
        .footer-links {margin-top: 1rem;display: flex;justify-content: center;gap: 1.5rem;font-weight: 500;}
        .footer-links a {color: var(--sub-text-color);text-decoration: none;}
        /* Single Post specific styles */
        .post-container { max-width: 800px; margin: 2rem auto; }
        .post-card-single { background: var(--card-color); padding: 2rem; border-radius: 1rem; box-shadow: var(--shadow); }
        .post-hero-image { width: 100%; height: auto; max-height: 400px; object-fit: cover; border-radius: 1rem; margin-bottom: 2rem; }
        .post-title { font-size: 2.5rem; line-height: 1.2; margin-bottom: 1rem; }
        .post-meta-single { color: var(--sub-text-color); margin-bottom: 2rem; border-bottom: 1px solid #eee; padding-bottom: 1rem; }
        .post-content-area { font-size: 1.1rem; line-height: 1.8; color: #333; }
        .post-content-area p { margin-bottom: 1.5rem; }
        .post-content-area h1, .post-content-area h2, .post-content-area h3 { margin: 2rem 0 1rem 0; color: var(--text-color); }
        .post-content-area a { color: var(--primary-color); text-decoration: underline; }
        .post-content-area img { max-width: 100%; height: auto; border-radius: 8px; }
        .post-content-area .in-post-ad { margin: 2rem 0; text-align: center; }
        .skeleton { background-color: #e0e0e0; animation: shimmer 1.5s infinite ease-in-out; border-radius: 4px; }
        @keyframes shimmer { 0% { opacity: 0.8; } 50% { opacity: 0.4; } 100% { opacity: 0.8; } }
        @media (max-width: 768px) { .post-card-single { padding: 1.5rem; } .post-title { font-size: 2rem; } }
    </style>
</head>
<body class="or-lang">
    <!-- Header (Identical to blog.html) -->
    <header id="main-header">
      <div class="container header-content">
        <a href="/" class="header-left" data-key="logo_text">ଓଡ଼ିଆ ଖେଳ</a>
        <div class="header-right">
          <nav class="main-nav desktop-nav">
            <a href="/" data-key="nav_home"></a>
            <a href="/blog/" data-key="nav_blog"></a>
          </nav>
          <button id="lang-toggle-btn" class="lang-toggle-btn"></button>
          <button id="menu-toggle" aria-label="Toggle Menu"><i class="bi bi-list"></i></button>
        </div>
      </div>
    </header>
    <nav class="main-nav mobile-nav" id="mobile-nav">
      <div class="mobile-nav-panel">
        <a href="/" data-key="nav_home"></a>
        <a href="/blog/" data-key="nav_blog"></a>
        <a href="/about/" data-key="nav_about"></a>
        <a href="/terms/" data-key="nav_termss"></a>
        <a href="/privacy-policy/" data-key="nav_privacys"></a>
        <a href="mailto:message.sbg@gmail.com" data-key="nav_advertise"></a>
      </div>
    </nav>
    <main>
        <div id="post-container" class="post-container">
            <!-- Skeleton Loader -->
            <div class="skeleton" style="height: 300px; width: 100%; border-radius: 1rem;"></div>
            <div class="skeleton" style="height: 50px; width: 80%; margin-top: 2rem;"></div>
            <div class="skeleton" style="height: 20px; width: 40%; margin-top: 1rem; margin-bottom: 2rem;"></div>
        </div>
    </main>
    <footer>
      <div class="container">
        <p data-key="footer_copyright"></p>
        <div class="footer-links"><a href="/terms/" data-key="nav_termss"></a><a href="/privacy-policy/" data-key="nav_privacys"></a><a href="/about/" data-key="nav_about"></a></div>
      </div>
    </footer>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const translations = {
                or: { nav_home: "ହୋମ୍", nav_blog: "ବ୍ଲଗ୍", nav_about: "ଆମ ବିଷୟରେ", nav_termss: "ସର୍ତ୍ତାବଳୀ", nav_privacys: "ଗୋପନୀୟତା", logo_text: "ଓଡ଼ିଆ ଖେଳ", footer_copyright: "© ୨୦୨୫ ଓଡ଼ିଆ ଖେଳ" },
                en: { nav_home: "Home", nav_blog: "Blog", nav_about: "About Us", nav_termss: "Terms", nav_privacys: "Privacy", logo_text: "Odia Games", footer_copyright: "© 2025 Odia Games" }
            };
            let currentLang = 'or';
            let inPostAdCode = '';
            let currentPostData = null; // Store current post data
            const langToggleBtn = document.getElementById('lang-toggle-btn');
            const postContainer = document.getElementById('post-container');
            const firebaseConfig = { apiKey: "AIzaSyCI8CEVsIm04yshvJVAZqQcElE_G-VaduQ", authDomain: "odia-games-visitor-counter.firebaseapp.com", projectId: "odia-games-visitor-counter" };
            firebase.initializeApp(firebaseConfig);
            const db = firebase.firestore();

            const setLanguage = (lang) => {
                currentLang = (lang === 'en') ? 'en' : 'or';
                localStorage.setItem("userLanguage", currentLang);
                document.documentElement.lang = currentLang;
                document.body.className = `${currentLang}-lang`;
                langToggleBtn.textContent = (currentLang === 'en') ? 'ଓ' : 'E';
                document.querySelectorAll("[data-key]").forEach(el => {
                    if (translations[currentLang][el.dataset.key]) el.textContent = translations[currentLang][el.dataset.key];
                });
                if (currentPostData) {
                    renderPost(currentPostData); // Re-render the same post in the new language
                }
            };

            const updateSEOTags = (post) => {
                const title = currentLang === 'or' && post.title_or ? post.title_or : post.title_en;
                const metaDesc = currentLang === 'or' && post.meta_description_or ? post.meta_description_or : post.meta_description_en;
                const postUrl = `https://odiagames.site/blog/${post.slug}`;
                
                document.title = `${title} - Odia Games`;
                document.querySelector('meta[name="description"]').setAttribute('content', metaDesc);
                
                // Update Open Graph tags for Facebook/WhatsApp
                document.querySelector('meta[property="og:title"]').setAttribute('content', title);
                document.querySelector('meta[property="og:description"]').setAttribute('content', metaDesc);
                document.querySelector('meta[property="og:image"]').setAttribute('content', post.thumbnailUrl);
                document.querySelector('meta[property="og:url"]').setAttribute('content', postUrl);

                // Update Twitter card tags
                document.querySelector('meta[name="twitter:title"]').setAttribute('content', title);
                document.querySelector('meta[name="twitter:description"]').setAttribute('content', metaDesc);
                document.querySelector('meta[name="twitter:image"]').setAttribute('content', post.thumbnailUrl);

                // Update canonical URL
                let canonical = document.querySelector('link[rel="canonical"]');
                if (!canonical) {
                    canonical = document.createElement('link');
                    canonical.setAttribute('rel', 'canonical');
                    document.head.appendChild(canonical);
                }
                canonical.setAttribute('href', postUrl);
            };
            
            const injectAd = (contentHtml, adCode) => {
                if (!adCode || !contentHtml) return contentHtml;
                const paragraphs = contentHtml.split('</p>');
                if (paragraphs.length > 2) {
                    paragraphs.splice(2, 0, `<div class="in-post-ad">${adCode}</div>`);
                }
                return paragraphs.join('</p>');
            };

            const renderPost = (post) => {
                const title = currentLang === 'or' && post.title_or ? post.title_or : post.title_en;
                let content = currentLang === 'or' && post.content_or ? post.content_or : post.content_en;
                const author = post.author || 'Odia Games Team';
                const date = post.createdAt ? new Date(post.createdAt.seconds * 1000).toLocaleDateString(currentLang === 'or' ? 'or-IN' : 'en-US') : '';
                
                updateSEOTags(post);
                const contentWithAd = injectAd(content, inPostAdCode);
                postContainer.innerHTML = `<div class="post-card-single"><img src="${post.thumbnailUrl}" alt="${title}" class="post-hero-image"><h1 class="post-title">${title}</h1><div class="post-meta-single"><span>By ${author}</span> • <span>${date}</span></div><div class="post-content-area">${contentWithAd}</div></div>`;
            };

            const fetchPost = async () => {
                try {
                    const path = window.location.pathname;
                    const slug = path.substring(path.lastIndexOf('/') + 1);
                    if (!slug) { postContainer.innerHTML = '<h1>Post not found</h1>'; return; }

                    const query = db.collection('posts').where('slug', '==', slug).limit(1);
                    const snapshot = await query.get();

                    if (snapshot.empty) { postContainer.innerHTML = '<h1>404 - Post Not Found</h1>'; return; }
                    
                    currentPostData = snapshot.docs[0].data();
                    renderPost(currentPostData);

                } catch (error) { postContainer.innerHTML = `<h1>Error loading post.</h1>`; }
            };

            const initializeApp = async () => {
                // Fetch ad code first
                try { const doc = await db.collection('settings').doc('blogSettings').get(); if (doc.exists) inPostAdCode = doc.data().inPostAdCode || ''; } catch (e) { /* silent fail */ }
                
                const savedLang = localStorage.getItem("userLanguage");
                const initialLang = savedLang ? savedLang : await (async () => { try { const r = await fetch(`https://ipinfo.io/json?token=9f0cd4dbf91e59`); if (!r.ok) return 'or'; const d = await r.json(); return (d.region && d.region !== 'Odisha') ? 'en' : 'or'; } catch (e) { return 'or'; } })();
                
                // Set language first, then fetch post
                currentLang = (initialLang === 'en') ? 'en' : 'or';
                localStorage.setItem("userLanguage", currentLang);
                document.documentElement.lang = currentLang;
                document.body.className = `${currentLang}-lang`;
                langToggleBtn.textContent = (currentLang === 'en') ? 'ଓ' : 'E';
                document.querySelectorAll("[data-key]").forEach(el => {
                    if (translations[currentLang][el.dataset.key]) el.textContent = translations[currentLang][el.dataset.key];
                });

                await fetchPost();
            };

            langToggleBtn.addEventListener('click', () => setLanguage((currentLang === 'en') ? 'or' : 'en'));
            const menuToggle = document.getElementById('menu-toggle');
            const mobileNav = document.getElementById('mobile-nav');
            menuToggle.addEventListener('click', () => mobileNav.classList.toggle('active'));
            mobileNav.addEventListener('click', e => { if (e.target === mobileNav) mobileNav.classList.remove('active'); });

            initializeApp();
        });
    </script>
</body>
</html>
