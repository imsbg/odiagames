<!DOCTYPE html>
<html lang="or">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Odia Games Blog</title>
    <meta name="description" content="Read articles from the Odia Games blog.">
    <!-- Other meta tags as before -->
    <meta name="theme-color" content="#f4f7fc" />
    <link rel="preconnect" href="https://fonts.googleapis.com" /><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Oriya:wght@400;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" />
    <style>
        /* All your existing CSS goes here. It is unchanged. */
        :root {--bg-color: #f4f7fc;--card-color: #ffffff;--text-color: #1c1c1e;--sub-text-color: #6c757d;--primary-color: #0a2463;--shadow: 0 10px 30px rgba(0, 0, 0, 0.07);}
        * {margin: 0;padding: 0;box-sizing: border-box;}
        html {scroll-behavior: smooth;}
        body {font-family: "Poppins", sans-serif;background-color: var(--bg-color);color: var(--text-color);line-height: 1.6;display: flex;flex-direction: column;min-height: 100vh;}
        body.or-lang {font-family: "Noto Sans Oriya", sans-serif;}
        .container {max-width: 1200px;margin: 0 auto;padding: 0 20px;}
        main {flex-grow: 1;padding-top: 2rem;}
        header {padding: 1.25rem 0;position: sticky;top: 0;z-index: 1000;background-color: rgba(244, 247, 252, 0.85);backdrop-filter: blur(10px);-webkit-backdrop-filter: blur(10px);border-bottom: 1px solid rgba(0, 0, 0, 0.05);}
        .header-content {display: flex;justify-content: space-between;align-items: center;}
        .header-left {font-size: 1.5rem;font-weight: 700;text-decoration: none;color: var(--text-color);}
        .header-right {display: flex;align-items: center;gap: 1.5rem;}
        .main-nav a {text-decoration: none;color: var(--text-color);font-weight: 500;transition: color 0.3s;padding: 0.5rem;}
        .lang-toggle-btn {background-color: var(--primary-color);color: #fff;border: none;width: 40px;height: 40px;border-radius: 50%;cursor: pointer;font-size: 1.1rem;font-weight: 700;display: flex; justify-content: center; align-items: center;}
        footer {background: var(--bg-color);color: var(--text-color);padding: 2rem 0;text-align: center;margin-top: 4rem;border-top: 1px solid #e0e0e0;}
        .footer-links {margin-top: 1rem;display: flex;justify-content: center;gap: 1.5rem;font-weight: 500;}
        .footer-links a {color: var(--sub-text-color);text-decoration: none;}
        .post-container { max-width: 800px; margin: 2rem auto; }
        .post-card-single { background: var(--card-color); padding: 2rem; border-radius: 1rem; box-shadow: var(--shadow); }
        .post-hero-image { width: 100%; height: auto; max-height: 400px; object-fit: cover; border-radius: 1rem; margin-bottom: 2rem; }
        .post-title { font-size: 2.5rem; line-height: 1.2; margin-bottom: 1rem; }
        .post-meta-single { color: var(--sub-text-color); margin-bottom: 2rem; border-bottom: 1px solid #eee; padding-bottom: 1rem; }
        .post-content-area { font-size: 1.1rem; line-height: 1.8; color: #333; }
        .error-details { background-color: #ffebee; color: #c62828; border: 1px solid #c62828; padding: 15px; border-radius: 8px; margin-top: 2rem; }
        .error-details pre { background-color: #ffcdd2; padding: 10px; border-radius: 5px; white-space: pre-wrap; word-wrap: break-word; font-family: monospace; }
    </style>
</head>
<body>
    <header id="main-header">
        <!-- Your full header HTML here -->
    </header>
    <main>
        <div id="post-container" class="post-container">
             <!-- Initial loader -->
            <p>Loading post...</p>
        </div>
    </main>
    <footer>
        <!-- Your full footer HTML here -->
    </footer>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // All your translations and other setup variables go here...
            const postContainer = document.getElementById('post-container');
            const firebaseConfig = { apiKey: "AIzaSyCI8CEVsIm04yshvJVAZqQcElE_G-VaduQ", authDomain: "odia-games-visitor-counter.firebaseapp.com", projectId: "odia-games-visitor-counter" };
            firebase.initializeApp(firebaseConfig);
            const db = firebase.firestore();

            const loadPost = async () => {
                try {
                    const path = window.location.pathname;
                    // Important: Ensure we handle trailing slashes
                    const slug = path.replace(/\/blog\/?/, '').replace(/\/$/, ''); 

                    if (!slug) {
                        postContainer.innerHTML = '<h1>Error: No post specified in URL.</h1><p>Please check the link and try again.</p>';
                        return;
                    }

                    const query = db.collection('posts').where('slug', '==', slug).limit(1);
                    const snapshot = await query.get();

                    if (snapshot.empty) {
                        postContainer.innerHTML = `
                            <h1>404 - Post Not Found</h1>
                            <p>We couldn't find a post with the slug: <strong>${slug}</strong></p>
                            <p>Please check the URL or go back to the <a href="/blog">main blog page</a>.</p>
                        `;
                        return;
                    }
                    
                    // If we reach here, the post was found. Render it.
                    const post = snapshot.docs[0].data();
                    // ... All your rendering logic ...
                    postContainer.innerHTML = `
                        <div class="post-card-single">
                            <img src="${post.thumbnailUrl}" alt="${post.title_en}" class="post-hero-image">
                            <h1 class="post-title">${post.title_en}</h1>
                            <div class="post-meta-single">By ${post.author}</div>
                            <div class="post-content-area">${post.content_en}</div>
                        </div>
                    `;

                } catch (error) {
                    // *** THIS IS THE NEW, IMPORTANT PART ***
                    // If ANY error happens in the 'try' block, it will be caught here
                    // and displayed on the screen for us to see.
                    console.error("DEBUGGING: An error was caught:", error); // Also log it just in case
                    postContainer.innerHTML = `
                        <div class="error-details">
                            <h1>An Error Occurred</h1>
                            <p>We couldn't load this post. Please try again later.</p>
                            <hr style="margin: 1rem 0;">
                            <p><strong>Error Details for Admin:</strong></p>
                            <pre>${error.toString()}</pre>
                            <p style="margin-top: 1rem;"><strong>Possible Causes:</strong></p>
                            <ul>
                                <li>A missing Firestore Index (Check browser console for a link to create it).</li>
                                <li>Incorrect Firestore Security Rules for the 'posts' collection.</li>
                                <li>A network problem or ad blocker interfering with Firebase.</li>
                            </ul>
                        </div>
                    `;
                }
            };

            // Start the process
            loadPost();
        });
    </script>
</body>
</html>
